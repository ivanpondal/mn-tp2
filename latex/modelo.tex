\subsection{Rankings de Páginas Web}

Hoy en día la cantidad de páginas web en todo el mundo asciende a una cantidad de
4.79 billones (sólo las indexadas). Es por esta razón que los buscadores
(Search Engines) cumplen un rol tan importante en el uso diario de internet desde
hace muchos años.

Dichos buscadores nos permiten realizar busquedas de páginas web mediante distintos
criterios, facilitando el acceso a la información.

Un posible criterio (bastante utilizado) es considerar que las páginas web populares
son las más buscadas. De esta forma, el buscador puede ofrecernos en orden descendiente
de popularidad los resultados obtenidos, esperando que encontremos más rápido lo
 que buscamos.

 Siguiendo esta intuición, se han elaborado diferentes algoritmos para ``rankear''
 las páginas web. A continuación presentaremos el famoso método PageRank, utilizado
 por Google en sus comienzos.

\subsubsection{PageRank}

El algoritmo de PageRank\footnote{Kurt Bryan and Tanya Leise. The linear algebra
behind google. SIAM Review, 48(3):569–581, 2006.} se define para un conjunto de
páginas Web $ = \{ 1,\dots, n \}$ de forma tal de asignar a cada una de ellas un
 puntaje que determine la importancia relativa de la página respecto de las demás.

Llamemos $x_j$ al puntaje asignado a la página $j\in\ Web$, que es lo que buscamos
calcular.

Ahora, un link saliente de la página $j$ a la página $i$ puede significar que $i$
 es una página importante. Pero bien podría ser que $j$ sea una página muy poco
 importante, por lo que deberíamos ponderar sus links salientes para decidir
 la importancia de las páginas a las que apunta.

Luego, vamos a considerar que la importancia de la página $i$ obtenida mediante el
link de $j$ es proporcional a la importancia de $j$ e inversamente proporcional
al grado de $j$. Entonces, si $L_k \in\ Web$ es el conjunto de páginas web que
apuntan a la página $k$:

\begin{equation} \label{eq:puntajes_page_rank}
    x_k = \sum\limits_{j \in\ L_k}{\frac{x_j}{n_j}},\quad k=1,\dots,n
\end{equation}

En este algoritmo, hallaramos los $x_k$ modelando el problema como una cadena de
 Markov, a la cual llamaremos Matriz de Transición, y que construiremos de la siguiente forma:

\begin{enumerate}
	\item Sea $G$ el grafo de la Web, dónde cada vértice es una página web y un
		eje de $v$ a $u$ significa que la página $v$ tiene link saliente hacia $u$.
	\item Luego, sea $W\in\{0,1\}^{n \times n}$ la \textit{matriz de conectividad} de $G$, tal
        que la celda $\{i,j\}$ tiene un 1 si hay un link saliente de la $j$-ésima página
        a la $i$-ésima página (los \textit{autolinks} son ignorados, o lo que es lo mismo,
        $\forall\ 1\leq i\leq n\ W_{i,i}$).
	\item Si definimos $n_j = \sum\limits_{i=1}^{n}{W_{i,j}}$ como el grado de $j$
        (la cantida de links salientes), entonces podemos definir la matriz
        $P\in\mathbb{R}^{n \times n}$, tal que la $P_{i,j} = 1/n_{j} * W_{i,j} $, y
        $P$ es estocástica por columnas.

        Además, notese que resolver el sistema dado por \ref{eq:puntajes_page_rank}
        es equivalente a encontrar un $x\in\mathbb{R}^n$ tal que $Px=x$.
        Es decir, encontrar el autovector asociado al autovalor 1 de $P$ tal que
        $x_i > 0$ y $\sum\limits_{i=1}^{n}{x_i} = 1$.
    \item Ahora, puede pasar que para algún $j$, $n_j = 0$ lo que indicaría que
        la página $j$ no tiene ningún link saliente. Para remediar
        estos casos, vamos a modificar $P$ utilizando la idea del  \textit{navegante
        aleatorio}, de forma tal que para un $j$ sin links salientes, la probabilidad
        de que el navegante salte a cualquier otra página $i$ es $1/n$.

        Entonces, $P_{1} = P + D$, dónde $D = vd^{t}$, $d\in\{0,1\}^{n}$ tal que
        $d_j = 1$ si $n_j = 0$, y $d_j = 0$ en caso contrario, y $v\in\mathbb{R}^n$
         tal que $v_j = 1/n$.
    \item Entonces, $P_{1}$ es estocástica por columnas, pero puede que no sea regular.
        Para que sí lo sea, extendemos el concepto anterior a todas las páginas
        (fenómeno de \textit{teletransportación}).

        Luego, $P_{2} = c*P_{1} + (1-c)*E$, donde $\forall\ 1\leq i,j\leq n,\ E_{i,j} = 1/n$,
        y $c\in(0,1)$. Llamamos a $c$ coeficiente de teletransportación.

        Lo que nos queda es un matriz $P_{2}$ estocástica por columnas y $\forall\ 1\leq i,j\leq n,\ (P_{2})_{i,j} > 0$.
\end{enumerate}

Una vez que tenemos la Matriz de Transición, generaremos el puntaje para cada página
 buscando el autovector $w$ del autovalor 1 de $P_{2}$, tal que $P_{2}w = w$ y
$w$ sea un vector de probabilidades (normalizado con norma 1).

Es decir, generar el ranking de páginas equivale a aplicar el método de la potencia
a la matriz $P_{2}$ y una vez hallado el $w$ mencionado, ordenar los puntajes de
mayor a menor:

\begin{equation} \label{eq:ranking_page_rank}
    ranking = \{ p_1, \dots, p_n \}, \text{donde } \forall\ i=1,\dots,n-1,\ w_{p_{i}} \geq w_{p_{i+1}}
\end{equation}

\subsubsection{PageRank con matriz Esparsa}

\subsection{Rankings en competencias deportivas}

Elegir un sistema de puntos que sea justo para todos los participantes en un
deporte no es una tarea sencilla. Existen muchos factores que afectan el
resultado de una competencia como lo pueden ser el orden en el que deben
competir entre si los equipos, generando desbalances respecto las capacidades de
cada uno. Es por esto que a continuación presentaremos el modelo GeM
\footnote{Angela Y. Govan, Carl D. Meyer, and Rusell Albright. Generalizing
google’s pagerank to rank national football league teams. In Proceedings of SAS
Global Forum 2008, 2008.} que busca modelar los resultados de forma tal que estos
factores impacten lo menos posible en el posicionamiento final de la tabla de
puntajes.

Con el fin de experimentar con distintos modelos, a lo largo del informe
trabajaremos sobre los resultados del Torneo de Primera División
2015\footnote{Campeonato de Primera División 2015, \textit{Julio H. Grondona} \\
\url{http://www.afa.org.ar/html/9/estadisticas-de-primera-division}}, donde
utilizaremos el sistema de ranking estándar de la AFA como punto de comparación.

\subsubsection{Generalized Markov chains Method (GeM)}

\subsubsection*{Definición del método}

El método GeM es el resultado de tomar el algoritmo PageRank y mediante pequeñas
modificaciones utilizar su potencial para establecer un ranking de equipos.
Análogo a PageRank, los equipos pasan a formar parte de un grafo dirigido
con pesos, donde cada nodo representa un equipo y los pesos de cada arista
reflejan el resultado de los partidos jugados entre los vértices conectados.

~

Formalmente, el modelado se realiza de la siguiente manera:
\begin{enumerate}
	\item Representamos el torneo como un grafo con pesos dirigidos de $n$
	nodos, donde $n$ es igual a la cantidad de equipos que participan. Cada
	equipo tiene su respectivo nodo y las aristas contienen como peso la
	diferencia positiva entre los nodos conectados.

	\item Definimos la matriz de adyacencia $A \in \mathbb{R}^{n \times n}$.
		\begin{equation*}
			A_{ij} =
				\begin{cases}
					w_{ij} & \text{si el equipo $i$ perdió contra $j$}\\
					0 & \text{caso contrario}
				\end{cases}
		\end{equation*}
		Donde $w_{ij}$ es la suma total de diferencia positiva de puntaje sobre todos
		los partidos en los que $i$ perdió contra $j$.

	\item Definimos la matriz $H \in \mathbb{R}^{n \times n}$.
		\begin{equation*}
			H_{ij} =
				\begin{cases}
					A_{ij}/\sum_{k = 1}^{n}A_{ik} & \text{si hay un link de $i$ a $j$}\\
					0 & \text{caso contrario}
				\end{cases}
		\end{equation*}

	\item Definimos la matriz GeM, $G \in \mathbb{R}^{n \times n}$ con $u, v, a, e \in \mathbb{R}^n$ y $c \in \mathbb{R}$.
		\begin{gather*}
			G = c(H + au^{t}) + (1 - c)ev^{t} \\
			\sum_{k = 1}^{n}v_{k} = 1 \qquad \sum_{k = 1}^{n}u_{k} = 1 \qquad \forall_{i = 1..n} e_{i} = 1 \\
			0 \leq c \leq 1 \qquad
			a_{i} =
			\begin{cases}
				1 & \text{si la fila $i$ de $H$ es un vector nulo} \\
				0 & \text{caso contrario}
			\end{cases}
		\end{gather*}

	\item Por último tenemos que el ranking de los equipos estará definido por
		el vector $\pi \in \mathbb{R}^n$ tal que
		\begin{gather*}
			\pi^{t} = \pi^{t}G \\
			\text{o si tomamos la transpuesta en ambos lados} \\
			G^{t}\pi = \pi
		\end{gather*}
\end{enumerate}

De esta forma al igual que con PageRank, calculando el autovector $\pi$
obtenemos nuestro ranking. Este modelo permite cierta flexibidad a partir del
$u$, $v$ y $c$ que tomemos.

El vector de probabilidad $u$ se aplicará en el caso de que un equipo se encuentre invicto, esto
es el equivalente a que en PageRank un sitio no tenga ningún link entrante, por
lo tanto su tratamiento es el mismo, se le asigna a la fila correspondiente el
vector con las probabilidades de saltar a otro nodo. Por lo tanto, el vector $u$
nos permite definir con qué probabilidades un equipo invicto perdería contra el
resto de los participantes. En el caso de PageRank, este es un vector de
distribución uniforme, donde es igual la posibilidad de saltar a cualquiera de
los otros nodos, una posible alternativa sería definirlo como un vector cuyas
probabilidades se basen en algún ranking anterior.

El vector de probabilidad $v$, nos da otro tipo de personalización que es
la del \textit{navegante aleatorio}. Esta es la probabilidad de que un equipo
cualquiera independientemente de los resultados registrados, pierda contra el
resto de los equipos. En PageRank, esto lo veíamos como la posibilidad de que
estando navegando el grafo, uno se \textit{teletransportará} a otro nodo
independientemente de las conexiones de los mismos. Este vector por defecto
también suele tomar el valor de la distribución uniforme.

Por último tenemos nuestro valor $c$ que actua como un factor de amortiguación
donde lo que se modifica es cuánto afecta el \textit{navegante aleatorio} al
resultado final, donde con $c = 0$, únicamente influye el \textit{navegante
aleatorio} y con $c = 1$ se elimina el efecto del mismo.

\subsubsection*{Modelado del empate}

Una particularidad de este sistema que se puede observar en la definición del
mismo es que no contempla los partidos donde hubo empate. Un empate equivale
a que no exista un perdedor y por ende no se modifica el peso de ningún nodo.
Para deportes donde el empate no es algo frecuente esto no sería un problema,
pero si tomamos como ejemplo el fútbol, donde los empates son algo mucho más
común, el ignorar estos partidos afecta notablemente el ranking.

Podemos tomar como ejemplo los Torneos Argentinos de Primera División y
observar el porcentaje de partidos empatados sobre el total que se jugaron.

\begin{table}[H]
	\centering
	\begin{tabular}{|cccc|}
		\hline
		Campeonato de Primera División & Partidos & Empates &  Empates/Partidos \\ \hline
		2015 & 390 & 126 & 0.32 \\ \hline
		2014 & 190 & 45 & 0.23 \\ \hline
		2013/14 & 380 & 117 & 0.31 \\ \hline
	\end{tabular}
	\caption*{Relación entre partidos jugados y empates totales}
\end{table}

Como podemos ver, la proporción de partidos empatados no es menor, con lo cual
analizaremos cómo impactaría esto en el método GeM. Como mencionamos en la
definición del modelo, los pesos de las aristas en el grafo dependen en parte de la
diferencia de puntaje con la que gana un equipo sobre otro.

Al encontrarnos con un empate no existe diferencia alguna, por lo tanto no
implica ningún cambio en el sistema. Esto podría defavorecer a los equipos que
más empates tuvieran en la temporada, ya que sólo los partidos donde hubieran
ganado o perdido afectarían su lugar en la tabla de puntajes. Además podría
suceder que un equipo perdiese contra un contrincante que no tuviera mucho peso
pero empatara contra un puntero, y esto debería verse reflejado ya que de otra
manera, sólo quedaría registrado su partido perdido.

Una posible forma de representar los empates aprovechando la estructura del
modelo actual sería cuando se produce uno, reflejar en el grafo el equivalente a
que ambos equipos hubieran perdido entre si, asignando como diferencia de
puntaje el valor con el que empataron. De esta forma no solo incluiríamos este
escenario al cálculo del ranking final, si no que además el puntaje con el que
empataron tendría peso.

\subsubsection{Puntaje AFA}

A modo de comparación con el método GeM, siendo que trabajaremos sobre los
resultados del Torneo de Primera División, utilizaremos también el sistema de
puntajes que propone la
AFA\footnote{\url{http://www.afa.org.ar/upload/reglamento/Reglamento\_PrimeraDivision\_2015.pdf}}.
El mismo es bastante sencillo, donde lo que establece es que todos los equipos
comienzan con puntaje \textbf{0} y se les suma \textbf{1} punto en caso de
empate, \textbf{3} por victoria y \textbf{0} por derrota.

A primera vista, dada que la modalidad de este torneo es de todos contra todos,
donde cada equipo juega una vez contra el resto, el resultado debería reflejar
de forma justa el desempeño de cada participante. Sin embargo, para este torneo
en particular se aplicó una fecha adicional de \textit{clásicos}, donde cada
equipo vuelve a jugar contra su respectivo clásico. Este es un punto donde se
desequilibran un tanto las cosas ya que un participante podría tener asignado
como clásico un puntero, mientras que otro al último en la tabla de posiciones.
Para este sistema de puntuación ambos partidos serían tratados al igual quel
resto del torneo.
